<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1432" height="547" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Note left of Operator: Create a dose d=(t, s, n), \n print s and n on dose
Operator -> VaccinationRegistry: addDose(h(s), h(t, n))
Operator --> Vaccinator: Ship dose d
Note right of Vaccinator: Check if received dose\nmatches information in registry.
Vaccinator -> VaccinationRegistry: announceVaccination(h(s))
Note left of VaccinationRegistry: Dose is locked.
Note right of Vaccinator: Encrypt (t, n)\nusing patient's public key.
Vaccinator -> VaccinationRegistry: vaccinate(h(s), s, Patient, enc_Patient(t,n))
]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="251.9333267211914" y="20" width="97.06666564941406" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="261.9333267211914" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="261.9333267211914">Operator</tspan></text></g><g class="actor"><rect x="251.9333267211914" y="488.60000228881836" width="97.06666564941406" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="261.9333267211914" y="513.6000022888184" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="261.9333267211914">Operator</tspan></text></g><line x1="300.46665954589844" x2="300.46665954589844" y1="59" y2="488.60000228881836" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="430.8833236694336" y="20" width="203.03334045410156" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="440.8833236694336" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="440.8833236694336">VaccinationRegistry</tspan></text></g><g class="actor"><rect x="430.8833236694336" y="488.60000228881836" width="203.03334045410156" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="440.8833236694336" y="513.6000022888184" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="440.8833236694336">VaccinationRegistry</tspan></text></g><line x1="532.3999938964844" x2="532.3999938964844" y1="59" y2="488.60000228881836" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="927.733325958252" y="20" width="116.33333587646484" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="937.733325958252" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="937.733325958252">Vaccinator</tspan></text></g><g class="actor"><rect x="927.733325958252" y="488.60000228881836" width="116.33333587646484" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="937.733325958252" y="513.6000022888184" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="937.733325958252">Vaccinator</tspan></text></g><line x1="985.8999938964844" x2="985.8999938964844" y1="59" y2="488.60000228881836" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="note"><rect x="20" y="79" width="260.46665954589844" height="48.20000076293945" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="25" y="99" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="25">Create a dose d=(t, s, n),</tspan><tspan dy="1.2em" x="25">print s and n on dose</tspan></text></g><g class="signal"><text x="310.46665954589844" y="157.70000076293945" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="310.46665954589844">addDose(h(s), h(t, n))</tspan></text><line x1="300.46665954589844" x2="532.3999938964844" y1="166.20000076293945" y2="166.20000076293945" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="590.1999931335449" y="196.70000076293945" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="590.1999931335449">Ship dose d</tspan></text><line x1="300.46665954589844" x2="985.8999938964844" y1="205.20000076293945" y2="205.20000076293945" style="stroke-width: 2px; stroke-dasharray: 6px, 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="1005.8999938964844" y="225.20000076293945" width="318.26666259765625" height="48.20000076293945" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1010.8999938964844" y="245.20000076293945" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1010.8999938964844">Check if received dose</tspan><tspan dy="1.2em" x="1010.8999938964844">matches information in registry.</tspan></text></g><g class="signal"><text x="638.7333297729492" y="303.9000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="638.7333297729492">announceVaccination(h(s))</tspan></text><line x1="985.8999938964844" x2="532.3999938964844" y1="312.4000015258789" y2="312.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="357.8999938964844" y="332.4000015258789" width="154.5" height="29" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="362.8999938964844" y="352.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="362.8999938964844">Dose is locked.</tspan></text></g><g class="note"><rect x="1005.8999938964844" y="381.4000015258789" width="270.1000061035156" height="48.20000076293945" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1010.8999938964844" y="401.4000015258789" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="1010.8999938964844">Encrypt (t, n)</tspan><tspan dy="1.2em" x="1010.8999938964844">using patient's public key.</tspan></text></g><g class="signal"><text x="542.3999938964844" y="460.10000228881836" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="542.3999938964844">vaccinate(h(s), s, Patient, enc_Patient(t,n))</tspan></text><line x1="985.8999938964844" x2="532.3999938964844" y1="468.60000228881836" y2="468.60000228881836" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g></svg>